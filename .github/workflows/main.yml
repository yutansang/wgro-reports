name: Parallel Generation (Fast & Slow Lanes)

permissions:
  contents: write

on:
  schedule:
    - cron: '0 * * * *' # æ¯å°æ—¶è¿è¡Œ
  workflow_dispatch:    # å…è®¸æ‰‹åŠ¨è§¦å‘

jobs:
  # ==================================================
  # ğŸš— å¿«è½¦é“ï¼šè¿è¡Œ zg, mg, wh (å‡ åˆ†é’Ÿæå®š)
  # ==================================================
  fast-lane:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repo
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10' # æ¨èä½¿ç”¨ 3.10ï¼Œæœ€ç¨³å®š

      - name: Install Dependencies
        run: |
          python -m pip install --upgrade pip
          pip install yfinance pandas numpy
          # å¿«è„šæœ¬ä¸éœ€è¦ baostockï¼Œè¿™é‡Œå°±ä¸è£…äº†ï¼ŒèŠ‚çœæ—¶é—´

      - name: Run Fast Scripts ğŸš€
        run: |
          echo ">>> [å¿«è½¦é“] å¼€å§‹è¿è¡Œå¿«è„šæœ¬..."
          python zg.py
          python mg.py
          python wh.py
          echo ">>> [å¿«è½¦é“] å¿«è„šæœ¬è¿è¡Œå®Œæ¯•ï¼"

      - name: Deploy Fast Reports
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          branch: gh-pages
          folder: .
          # ğŸ”¥ å…³é”®ï¼šåªæ›´æ–°æˆ‘ç”Ÿæˆçš„æ–‡ä»¶ï¼Œä¸åˆ é™¤åˆ«äººçš„æ–‡ä»¶
          clean: false 
          # é˜²æ­¢ git é”å†²çªï¼Œå¢åŠ ä¸€æ¬¡é‡è¯•
          git-config-email: action@github.com
          git-config-name: GitHub Action

  # ==================================================
  # ğŸ¢ æ…¢è½¦é“ï¼šè¿è¡Œ agd, agx (è€—æ—¶è¾ƒé•¿)
  # ==================================================
  slow-lane:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repo
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Install Dependencies
        run: |
          python -m pip install --upgrade pip
          # æ…¢è„šæœ¬éœ€è¦ baostockï¼Œè¿™é‡Œä¸“é—¨å®‰è£…
          pip install yfinance pandas numpy baostock

      - name: Run Slow Scripts ğŸ¢
        run: |
          echo ">>> [æ…¢è½¦é“] å¼€å§‹è¿è¡Œæ…¢è„šæœ¬ (è€—æ—¶è¾ƒé•¿ï¼Œè¯·è€å¿ƒç­‰å¾…)..."
          python agd.py
          python agx.py
          echo ">>> [æ…¢è½¦é“] æ…¢è„šæœ¬è¿è¡Œå®Œæ¯•ï¼"

      - name: Deploy Slow Reports
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          branch: gh-pages
          folder: .
          # ğŸ”¥ å…³é”®ï¼šåŒæ ·ä¸åˆ é™¤å¿«è½¦é“ç”Ÿæˆçš„æ–‡ä»¶
          clean: false 
          git-config-email: action@github.com
          git-config-name: GitHub Action
